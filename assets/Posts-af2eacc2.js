import{_ as k,u as V,r as y,w as T,o as i,c as g,F as C,a as I,b as s,d as W,e as E,f as A,g as j,t as f,n as _,h as N,i as x,j as U,p as z,k as R,C as q,L as M,E as F,A as H,T as O,l as G,m as P,q as J,s as b,v as w,x as K,y as S}from"./index-fec93108.js";import Q from"./ClientPostDetailsPage-954c2874.js";import X from"./RatingClientPage-a0c76d51.js";const Y={setup(){const l=V(),o=y([]);function e(c){const n=new Blob([new Uint8Array(c.data)],{type:"image/jpeg"});return URL.createObjectURL(n)}function t(c){o.value=c.result.portfolioPostsWithImages[0].images}return T(()=>{t(l.$state.images)}),{images:o,getImageUrl:e}}},Z=["src"];function $(l,o,e,t,c,n){return i(),g("div",null,[(i(!0),g(C,null,I(t.images,d=>(i(),g("div",{key:d.id},[s("img",{src:t.getImageUrl(d),alt:"image"},null,8,Z)]))),128))])}const tt=k(Y,[["render",$]]);const et={name:"Project",props:{post:{type:Object,required:!0}},components:{Image:tt},setup(l,o){const e=W(),t=E(),c=A(),n=j(),{timeDifference:d}=U();return{categoriesStore:e,languageStore:t,wilayasStore:c,clientDemandeStore:n,formatTime:r=>d(r),showPost:(r,m)=>{m!="delete"&&(n.$state.selectedPost=n.getClientPostById(r),n.getClientPostProviders(r).then(u=>{console.log("providers"),console.log(u)}),n.getClientPostImages(r).then(u=>{console.log("images"),console.log(u)}),n.clientPostPageVisibility=!0)},handleWorkStatus:r=>{r=="done"?(n.$state.selectedPost=l.post,n.getClientPostProviders(l.post.id),n.getClientPostImages(l.post.id).then(m=>{console.log("images"),console.log(m)}),n.clientPostPageVisibility=!1,n.RatingPageVisibility=!0):n.PostToDelte=l.post}}}},B=l=>(z("data-v-dd6f8b1f"),l=l(),R(),l),st={class:"flex flex-col justify-start items-start gap-0.5 w-full font-semibold"},ot={class:"text-lg text-secondary/90"},lt={class:"flex flex-row justify-between items-center w-full mt-4"},nt={class:"text-sm"},at={class:"text-xs text-gray-400 mr-2 flex items-center"},it=B(()=>s("span",{class:"material-icons text-sm text-gray-400"}," location_on ",-1)),rt={class:"text-xs text-gray-400"},dt={key:0,class:"divider my-1"},ct={key:1,class:"w-full h-full"},ut=B(()=>s("div",{class:"divider my-1"},null,-1)),gt={key:2,class:"btn btn-sm btn-ghost mt-2 text-success btn-disabled bg-success/0 w-full px-0"},ft={key:3,class:"btn btn-sm mt-2 btn-ghost btn-disabled text-error bg-error/0 w-full px-0"};function mt(l,o,e,t,c,n){return i(),g("div",{class:_(["relative flex flex-col justify-between items-start w-full h-full font-semibold shadow-lg border-x-2 border-t-2 px-2 pb-2 mb-2 rounded-xl notification-item",{"bg-white":e.post.status=="pending","bg-green-500/10":e.post.status=="done","bg-red-500/10":e.post.status=="delete"}])},[s("div",{onClick:o[0]||(o[0]=d=>t.showPost(e.post.id,e.post.status)),class:"flex flex-row items-center w-full h-full cursor-pointer"},[s("div",st,[s("p",ot,f(t.languageStore.getWord(t.categoriesStore.getCategoryById(e.post.categoryId))),1),s("div",lt,[s("div",{class:_(["flex px-2 rounded-full flex-row gap-1 items-center self-start",{"text-red-500 bg-red-500/20":e.post.urgency==="urgent","text-yellow-500 bg-yellow-500/20":e.post.urgency==="normal","text-green-500 bg-green-500/20":e.post.urgency==="low","text-blue-500 bg-blue-500/20":e.post.urgency==="unplanned"}])},[s("span",{class:_(["material-icons text-sm",{"text-red-500":e.post.urgency==="urgent","text-yellow-500":e.post.urgency==="normal","text-green-500":e.post.urgency==="low","text-blue-500":e.post.urgency==="unplanned"}])},f(e.post.urgency==="urgent"?"hourglass_full":e.post.urgency==="low"?"hourglass_empty":e.post.urgency==="normal"?"hourglass_bottom":"hourglass_disabled"),3),s("span",nt,f(e.post.urgency),1)],2),s("p",at,[it,N(f(t.wilayasStore.getWilayaById(e.post.stateId)),1)]),s("p",rt,f(t.formatTime(e.post.createdAt)),1)])])]),e.post.status==="pending"?(i(),g("div",dt)):x("",!0),e.post.status==="pending"?(i(),g("div",ct,[s("button",{onClick:o[1]||(o[1]=d=>t.handleWorkStatus("done")),class:"btn btn-sm text-success hover:bg-success hover:text-white btn-ghost w-full px-0"}," marque faite "),ut,s("label",{for:"delete-modal",onClick:o[2]||(o[2]=d=>t.handleWorkStatus("delete",e.post.id)),class:"btn btn-sm text-error btn-ghost hover:bg-error hover:text-white w-full px-0"}," supprimer ")])):x("",!0),e.post.status==="done"?(i(),g("button",gt," Done ")):x("",!0),e.post.status==="delete"?(i(),g("button",ft," Deleted ")):x("",!0)],2)}const xt=k(et,[["render",mt],["__scopeId","data-v-dd6f8b1f"]]);const _t={name:"ClientPosts",components:{ClientPostDetailsPage:Q,ClientLayout:q,Post:xt,RatingClientPage:X,Loading:M,Error:F,Alert:H,Toast:O},setup(){const l=j(),o=y([]),e=y(1),t=y(!1),c=y(""),n=y(""),d=G({id:null,status:null}),v=P(()=>r.value.filter(a=>a.status=="pending")),h=P(()=>r.value.filter(a=>a.status=="done")),p=P(()=>r.value.filter(a=>a.status=="delete")),r=P(()=>l.$state.clientPosts);J(()=>{l.getClientPosts(),o.value=l.$state.clientPosts});const m=a=>{a==="Total"?(o.value=r.value,e.value=1):a==="pending"?(o.value=v.value,e.value=2):a==="done"?(o.value=h.value,e.value=3):a==="delete"&&(o.value=p.value,e.value=4)},u=(a,D)=>{D==="delete"&&(d.id=a,d.status=D),console.log(d)},L=()=>{l.setWorkStatus("delete",l.PostToDelte.id).then(a=>{console.log(a),l.clientPostPageVisibility=!1,a.status===200?(console.log("status changed to deleted"),t.value=!0,c.value="Post deleted successfully",n.value="success",m("delete"),l.getClientPosts(),setTimeout(()=>{t.value=!1},3e3)):(console.log("status not changed"),t.value=!0,c.value="Post not deleted",n.value="error",setTimeout(()=>{t.value=!1},3e3))})};return T(()=>{t.value&&setTimeout(()=>{t.value=!1},3e3)}),{clientDemandeStore:l,Posts:o,pendingPosts:v,donePosts:h,deletePosts:p,position:e,errorStatus:t,errorMessage:c,errorState:n,filterPosts:m,handleWorkStatus:u,handleTreatPost:L}}},bt={class:"w-full pb-4 min-h-[70vh]"},yt={class:"grid grid-rows-1 grid-cols-4 rounded-xl py-2 px-2 place-items-center text-center w-full sm:w-full gap-1"},vt={class:"text-2xl font-bold text-blue-500"},ht=s("p",{class:"text-gray-400 mb-1 md:text-lg"},"Total",-1),pt={class:"text-2xl font-bold text-blue-500"},Pt=s("p",{class:"text-gray-400 mb-1"},"En attente",-1),wt={class:"text-2xl font-bold text-blue-500"},St=s("p",{class:"text-gray-400 mb-1 md:text-lg"},"réalisés",-1),Ct={class:"text-2xl font-bold text-blue-500"},kt=s("p",{class:"text-gray-400 mb-1 md:text-lg"}," Supprimés ",-1),Dt={key:2,class:"w-full h-full"},Tt={key:0,class:"flex flex-col justify-center items-center h-[80vh]"},It=s("span",{class:"material-icons text-5xl text-gray-300"}," post_add ",-1),jt=s("span",{class:"text-gray-300 text-lg font-semibold"},"No Project",-1),Bt=[It,jt],Lt={class:"flex flex-col justify-center items-center px-2 gap-4 w-full h-full"},Vt={class:"grido max-w-2xl gap-4 w-full h-full"};function Wt(l,o,e,t,c,n){const d=b("Loading"),v=b("Error"),h=b("Post"),p=b("Alert"),r=b("ClientLayout"),m=b("Toast");return i(),g(C,null,[w(r,{pageTitle:"Projects"},{default:K(()=>[s("div",bt,[s("div",yt,[s("div",{onClick:o[0]||(o[0]=u=>t.filterPosts("Total",1)),class:"w-full bg-gray-400/20 rounded-t-xl pt-2 cursor-pointer relative"},[s("p",vt,f(t.clientDemandeStore.$state.clientPosts.length),1),ht,s("div",{class:_([{"opacity-100":t.position===1,"opacity-0":t.position!==1,"translate-x-0":t.position===1,"-translate-x-full":t.position<1,"translate-x-full":t.position>1},"w-full h-1 bg-primary rounded-2xl absolute bottom-0 left-0 transition-transform duration-500"])},null,2)]),s("div",{onClick:o[1]||(o[1]=u=>t.filterPosts("pending",2)),class:"w-full bg-gray-400/20 rounded-t-xl pt-2 cursor-pointer relative"},[s("p",pt,f(t.pendingPosts.length),1),Pt,s("div",{class:_([{"opacity-100":t.position===2,"opacity-0":t.position!==2,"translate-x-0":t.position===2,"-translate-x-full":t.position<2,"translate-x-full":t.position>2},"w-full h-1 bg-primary rounded-2xl absolute bottom-0 left-0 transition-transform duration-500"])},null,2)]),s("div",{onClick:o[2]||(o[2]=u=>t.filterPosts("done",3)),class:"w-full bg-gray-400/20 rounded-t-xl pt-2 cursor-pointer relative"},[s("p",wt,f(t.donePosts.length),1),St,s("div",{class:_([{"opacity-100":t.position===3,"opacity-0":t.position!==3,"translate-x-0":t.position===3,"-translate-x-full":t.position<3,"translate-x-full":t.position>3},"w-full h-1 bg-primary rounded-2xl absolute bottom-0 left-0 transition-transform duration-500"])},null,2)]),s("div",{onClick:o[3]||(o[3]=u=>t.filterPosts("delete",4)),class:"w-full bg-gray-400/20 rounded-t-xl pt-2 cursor-pointer relative"},[s("p",Ct,f(t.deletePosts.length),1),kt,s("div",{class:_([{"opacity-100":t.position===4,"opacity-0":t.position!==4,"translate-x-0":t.position===4,"-translate-x-full":t.position<4,"translate-x-full":t.position>4},"w-full h-1 bg-primary rounded-2xl absolute bottom-0 left-0 transition-transform duration-500"])},null,2)])]),t.clientDemandeStore.loadingClientDemande&&!t.clientDemandeStore.errorClientDemande.status?(i(),S(d,{key:0,class:"fixed right-0 left-0 top-0 bottom-0 z-50"})):x("",!0),t.clientDemandeStore.errorClientDemande.status&&!t.clientDemandeStore.loadingClientDemande?(i(),S(v,{key:1,class:"fixed right-0 left-0 top-0 bottom-0 z-50"})):x("",!0),!t.clientDemandeStore.loadingClientDemande&&!t.clientDemandeStore.errorClientDemande.status?(i(),g("div",Dt,[t.Posts===null||t.Posts.length===0?(i(),g("div",Tt,Bt)):x("",!0),s("div",Lt,[s("div",Vt,[(i(!0),g(C,null,I(t.Posts,u=>(i(),S(h,{key:u.id,post:u},null,8,["post"]))),128))])])])):x("",!0)]),w(p,{onHandleCloseBtn:t.handleTreatPost,closeBtnText:"ok ?",toggleBtnText:"close",message:"do you really want to delete your project ???",modalName:"delete-modal"},null,8,["onHandleCloseBtn"])]),_:1}),w(m,{class:"z-50 top-0",color:t.errorState,message:t.errorMessage,isVisible:t.errorStatus},null,8,["color","message","isVisible"])],64)}const Ut=k(_t,[["render",Wt]]);export{Ut as default};
