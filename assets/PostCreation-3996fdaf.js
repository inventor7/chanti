import{P as E}from"./ProviderLayout-65b554ca.js";import{_ as U,T as V,A,g as L,G as j,u as z,D as H,K as M,l as N,r as g,m as q,w as C,s as x,o as f,c as m,v as p,x as b,F as y,b as e,n as T,a as B,i as F,O as I,P as R,h as S}from"./index-fec93108.js";import{P as O}from"./ProviderPosts-26ce9ae2.js";const G={name:"PostCreation",components:{ProviderLayout:E,Toast:V,Alert:A,ProviderPosts:O},setup(){const v=L(),d=j(),_=z(),t=H();M();const a=N([]);g({});const o=g(!1),r=g(""),l=g(""),u=g(""),w=()=>{t.deletePost(t.$state.postToDelete.id).then(s=>{s.status==200?(console.log("the post was deleted"),o.value=!0,r.value="Post deleted successfully",l.value="success",t.$state.postToDelete={}):(o.value=!0,r.value="Error deleting post",l.value="error",console.log("error deleting post"))})},n=()=>{console.log(t.$state.postToEdit),t.editPost(t.$state.postToEdit).then(s=>{s.status==200?(console.log(s),o.value=!0,r.value="Post edited successfully",l.value="success",t.$state.postToEdit={},t.getProviderPosts(d.$state.userAuth.id).then(i=>{console.log(" provider Posts"),console.log(i)})):(o.value=!0,r.value="Error in editing post",l.value="error",console.log(s))})};function c(s){const i=s.target.files;if(v.request.images.length>3)o.value=!0,r.value="You can only upload 3 images",l.value="error";else{for(let h=0;h<i.length;h++)a.push(i[h]);v.request.images=a}}const P=q(()=>a.map(s=>URL.createObjectURL(s))),D=()=>{document.querySelector('input[type="file"]').click()},k=()=>{const s=new FormData;if(a.length==0||u.value=="")o.value=!0,r.value="Please select images and write a description",l.value="error";else{s.append("details",u.value),s.append("providerId",d.$state.userAuth.id);for(let i=0;i<a.length;i++)s.append("images",a[i]);_.sendPost(s).then(i=>{i.status==200&&(console.log(i.status),o.value=!0,r.value="Post created successfully",l.value="success",a.splice(0,a.length),u.value="",setTimeout(()=>{o.value=!0,r.value="we are redirecting you to your profile",l.value="success"},3e3),t.getProviderPosts(d.$state.userAuth.id).then(h=>{console.log(" provider Posts"),console.log(h)}))})}};return C(()=>{o.value&&setTimeout(()=>{o.value=!1},3e3)}),C(()=>t.$state.postToEdit,()=>{u.value=t.$state.postToEdit.details,a.values=t.$state.postToEdit.images}),{providerStore:_,portfolioStore:t,handleFileClick:D,handleFileUpload:c,SendPost:k,handleDeletePost:w,handleEditPost:n,selectedFiles:a,selectedFileUrls:P,errorStatus:o,errorMessage:r,errorState:l,descText:u}}},K={class:"min-h-[75vh]"},Y=e("label",{for:"alert-modal",class:"btn btn-primary gap-1 rounded-3xl text-white fixed bottom-20 z-30 right-4 font-semibold"},[e("span",{class:"material-icons"}," add "),e("span",{class:"md:block"}," créer un poste ")],-1),J=e("div",{class:"w-full h-full flex flex-col items-center bg-white rounded-xl gap-2 mb-4 p-3"},[e("div",{class:"w-full h-full flex flex-row items-center bg-white rounded-xl gap-2"},[e("span",{class:"material-icons text-2xl text-warning"}," published_with_changes "),e("p",{class:"text-sm font-semibold"}," le post sera envoyé à l'administrateur pour approbation ")]),e("div",{class:"w-full h-full flex flex-row items-center bg-white rounded-xl gap-2"},[e("span",{class:"material-icons text-2xl text-success"}," verified "),e("p",{class:"text-sm font-semibold"}," le post sera publié directement ")])],-1),Q=e("h2",{class:"text-2xl font-bold mb-2"}," creation d'un post ",-1),W={class:"w-full bg-white border-2 p-2 rounded-2xl overflow-y-scroll h-full"},X={class:"flex flex-col md:flex-row w-full h-full rounded-2xl p-2 gap-2 font-semibold"},Z={class:"w-full h-full space-y-2"},$={for:"af-submit-app-upload-images",class:"group p-4 sm:p-7 block cursor-pointer text-center border-2 border-dashed border-gray-200 rounded-lg focus-within:outline-none focus-within:ring-2 focus-within:ring-blue-500 focus-within:ring-offset-2"},ee=e("svg",{class:"w-10 h-10 mx-auto text-gray-400",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16"},[e("path",{"fill-rule":"evenodd",d:"M7.646 5.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 6.707V10.5a.5.5 0 0 1-1 0V6.707L6.354 7.854a.5.5 0 1 1-.708-.708l2-2z"}),e("path",{d:"M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383zm.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z"})],-1),te=e("span",{class:"mt-2 block text-sm text-gray-800"},[S(" Selectionner des images à télécharger "),e("span",{class:"group-hover:text-blue-700 text-blue-600"}," (ou glisser-déposer) ")],-1),se={key:0,class:"max-w-xs h-full flex flex-row justify-around items-center gap-2"},le=["src","alt"],oe=["onClick"],ae=e("span",{class:"material-icons text-primary"}," cancel ",-1),re=[ae],ne={class:"h-4/6 w-full flex flex-col justify-center items-start gap-2"},ie=e("span",{class:"font-medium text-lg"}," Description ",-1),de=e("h2",{class:"text-2xl font-bold mb-2"},"Editing Post",-1),ce=e("p",{class:"font-semibold text-error text-sm mb-1"},"* you can just add images or modify Description",-1),ue={class:"w-full bg-white border-2 p-2 rounded-2xl overflow-y-scroll h-full"},fe={class:"flex flex-col md:flex-row w-full h-full rounded-2xl p-2 gap-2 font-semibold"},me={class:"w-full h-full space-y-2"},pe={for:"af-submit-app-upload-images",class:"group p-4 sm:p-7 block cursor-pointer text-center border-2 border-dashed border-gray-200 rounded-lg focus-within:outline-none focus-within:ring-2 focus-within:ring-blue-500 focus-within:ring-offset-2"},he=e("svg",{class:"w-10 h-10 mx-auto text-gray-400",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16"},[e("path",{"fill-rule":"evenodd",d:"M7.646 5.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 6.707V10.5a.5.5 0 0 1-1 0V6.707L6.354 7.854a.5.5 0 1 1-.708-.708l2-2z"}),e("path",{d:"M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383zm.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z"})],-1),ge=e("span",{class:"mt-2 block text-sm text-gray-800"},[S(" Select more images : "),e("span",{class:"group-hover:text-blue-700 text-blue-600"},"drag or drop")],-1),xe={key:0,class:"max-w-xs h-full flex flex-row justify-around items-center gap-2"},ve=["src","alt"],_e=e("div",{class:"h-4/6 w-full flex flex-col justify-center items-start gap-2"},[e("span",{class:"font-medium text-lg"},"Post Details"),e("textarea",{class:"w-full font-semibold h-full rounded-2xl border-2 border-gray-300 p-4"})],-1);function we(v,d,_,t,a,o){const r=x("ProviderPosts"),l=x("Alert"),u=x("ProviderLayout"),w=x("Toast");return f(),m(y,null,[p(u,null,{default:b(()=>[e("div",K,[Y,J,p(r),p(l,{w:"normal",closeBtnText:"Poster",onHandleCloseBtn:t.SendPost,closeBtnColor:"primary",toggleBtnText:"créer un poste"},{default:b(()=>[Q,e("div",W,[e("div",X,[e("div",Z,[e("label",$,[e("input",{id:"af-submit-app-upload-images",name:"af-submit-app-upload-images",type:"file",class:"sr-only",onChange:d[0]||(d[0]=(...n)=>t.handleFileUpload&&t.handleFileUpload(...n))},null,32),ee,te])]),e("div",{class:T(["h-full rounded-2xl",{"border-2":!t.selectedFiles.length}])},[t.selectedFiles.length?(f(),m("div",se,[(f(!0),m(y,null,B(t.selectedFileUrls,(n,c)=>(f(),m("div",{class:"relative h-full max-h-32 w-fit md:w-full",key:c},[e("img",{class:"object-fil max-h-32",src:n,alt:"Image "+(c+1)},null,8,le),e("span",{class:"absolute rounded-full w-6 h-6 flex justify-center items-center cursor-pointer -top-1.5 -right-1.5",onClick:P=>t.selectedFiles.splice(c,1)},re,8,oe)]))),128))])):F("",!0)],2)]),e("div",ne,[ie,I(e("textarea",{"onUpdate:modelValue":d[1]||(d[1]=n=>t.descText=n),rows:"4",cols:"50",maxlength:"100",class:"w-full font-semibold h-full rounded-2xl border-2 border-gray-300 p-4"},"                                                                                                                                                                          ",512),[[R,t.descText]])])])]),_:1},8,["onHandleCloseBtn"]),p(l,{onHandleCloseBtn:t.handleDeletePost,closeBtnText:"Delete",toggleBtnText:"Discard",message:"Delete the post permanetly ?",modalName:"delete-post-modal"},null,8,["onHandleCloseBtn"]),p(l,{onHandleCloseBtn:t.handleEditPost,closeBtnText:"Save",toggleBtnText:"Cancel",message:"",modalName:"edit-post-modal"},{default:b(()=>[de,ce,e("div",ue,[e("div",fe,[e("div",me,[e("label",pe,[e("input",{id:"af-submit-app-upload-images",name:"af-submit-app-upload-images",type:"file",class:"sr-only",onChange:d[2]||(d[2]=(...n)=>t.handleFileUpload&&t.handleFileUpload(...n))},null,32),he,ge])]),e("div",{class:T(["h-full rounded-2xl",{"border-2":!t.selectedFiles.length}])},[t.selectedFiles.length?(f(),m("div",xe,[(f(!0),m(y,null,B(t.selectedFileUrls,(n,c)=>(f(),m("div",{class:"relative h-full max-h-32 w-fit md:w-full",key:c},[e("img",{class:"object-fil max-h-32",src:n,alt:"Image "+(c+1)},null,8,ve)]))),128))])):F("",!0)],2)]),_e])]),_:1},8,["onHandleCloseBtn"])])]),_:1}),p(w,{class:"z-[70] top-0",color:t.errorState,message:t.errorMessage,isVisible:t.errorStatus},null,8,["color","message","isVisible"])],64)}const Ce=U(G,[["render",we]]);export{Ce as default};
